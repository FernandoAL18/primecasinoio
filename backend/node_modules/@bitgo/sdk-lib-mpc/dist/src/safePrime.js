"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateSafePrimes = exports.generateSafePrime = void 0;
const openssl_1 = require("./openssl");
async function generateSafePrime(bitlength, openSSLBytes) {
    const openSSL = new openssl_1.OpenSSL();
    await openSSL.init(openSSLBytes);
    return openSSL.generateSafePrime(bitlength);
}
exports.generateSafePrime = generateSafePrime;
async function generateSafePrimes(bitLengths, openSSLBytes) {
    const openSSL = new openssl_1.OpenSSL();
    await openSSL.init(openSSLBytes);
    const promises = bitLengths.map((bitlength) => {
        return openSSL.generateSafePrime(bitlength);
    });
    return await Promise.all(promises);
}
exports.generateSafePrimes = generateSafePrimes;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2FmZVByaW1lLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NhZmVQcmltZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSx1Q0FBb0M7QUFFN0IsS0FBSyxVQUFVLGlCQUFpQixDQUFDLFNBQWlCLEVBQUUsWUFBd0I7SUFDakYsTUFBTSxPQUFPLEdBQUcsSUFBSSxpQkFBTyxFQUFFLENBQUM7SUFDOUIsTUFBTSxPQUFPLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ2pDLE9BQU8sT0FBTyxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzlDLENBQUM7QUFKRCw4Q0FJQztBQUVNLEtBQUssVUFBVSxrQkFBa0IsQ0FBQyxVQUFvQixFQUFFLFlBQXdCO0lBQ3JGLE1BQU0sT0FBTyxHQUFHLElBQUksaUJBQU8sRUFBRSxDQUFDO0lBQzlCLE1BQU0sT0FBTyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNqQyxNQUFNLFFBQVEsR0FBc0IsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQWlCLEVBQUUsRUFBRTtRQUN2RSxPQUFPLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUM5QyxDQUFDLENBQUMsQ0FBQztJQUNILE9BQU8sTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3JDLENBQUM7QUFQRCxnREFPQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9wZW5TU0wgfSBmcm9tICcuL29wZW5zc2wnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVTYWZlUHJpbWUoYml0bGVuZ3RoOiBudW1iZXIsIG9wZW5TU0xCeXRlczogVWludDhBcnJheSk6IFByb21pc2U8YmlnaW50PiB7XG4gIGNvbnN0IG9wZW5TU0wgPSBuZXcgT3BlblNTTCgpO1xuICBhd2FpdCBvcGVuU1NMLmluaXQob3BlblNTTEJ5dGVzKTtcbiAgcmV0dXJuIG9wZW5TU0wuZ2VuZXJhdGVTYWZlUHJpbWUoYml0bGVuZ3RoKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlU2FmZVByaW1lcyhiaXRMZW5ndGhzOiBudW1iZXJbXSwgb3BlblNTTEJ5dGVzOiBVaW50OEFycmF5KTogUHJvbWlzZTxiaWdpbnRbXT4ge1xuICBjb25zdCBvcGVuU1NMID0gbmV3IE9wZW5TU0woKTtcbiAgYXdhaXQgb3BlblNTTC5pbml0KG9wZW5TU0xCeXRlcyk7XG4gIGNvbnN0IHByb21pc2VzOiBQcm9taXNlPGJpZ2ludD5bXSA9IGJpdExlbmd0aHMubWFwKChiaXRsZW5ndGg6IG51bWJlcikgPT4ge1xuICAgIHJldHVybiBvcGVuU1NMLmdlbmVyYXRlU2FmZVByaW1lKGJpdGxlbmd0aCk7XG4gIH0pO1xuICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xufVxuIl19