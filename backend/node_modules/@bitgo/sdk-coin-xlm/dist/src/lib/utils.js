"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.decodePrivateKey = exports.decodePublicKey = exports.encodePrivateKey = exports.encodePublicKey = exports.isValidRootPrivateKey = exports.isValidPrivateKey = exports.isValidStellarPrivateKey = exports.isValidStellarPrv = exports.isValidRootPublicKey = exports.isValidPublicKey = exports.isValidStellarPublicKey = exports.isValidStellarPub = exports.createStellarKeypairFromPrv = exports.createStellarKeypairFromPub = void 0;
const sdk_core_1 = require("@bitgo/sdk-core");
const stellar = __importStar(require("stellar-sdk"));
/**
 * Creates a Stellar keypair from a public key.
 * Public key can be either a raw root public key (hex string) or a Stellar public key (prefixed with 'G')
 * @param pub Either hex root public key or Stellar public key
 * @returns Stellar keypair from the provided pub
 */
function createStellarKeypairFromPub(pub) {
    if (pub.startsWith('G')) {
        if (!isValidStellarPublicKey(pub)) {
            throw new Error('Invalid Stellar public key');
        }
        return stellar.Keypair.fromPublicKey(pub);
    }
    const encodedPub = encodePublicKey(Buffer.from(pub, 'hex'));
    if (!isValidStellarPublicKey(encodedPub)) {
        throw new Error('Invalid root public key');
    }
    return stellar.Keypair.fromPublicKey(encodedPub);
}
exports.createStellarKeypairFromPub = createStellarKeypairFromPub;
/**
 * Creates a Stellar keypair from a private key.
 * Private key can be either a raw root private key (hex string) or a Stellar private key (prefixed with 'S').
 * @param secret Either hex root private key or Stellar private key
 * @returns Stellar keypair from the provided prv
 */
function createStellarKeypairFromPrv(prv) {
    if (prv.startsWith('S')) {
        if (!isValidStellarPrivateKey(prv)) {
            throw new Error('Invalid Stellar private key');
        }
        return stellar.Keypair.fromSecret(prv);
    }
    const encodedPrv = encodePrivateKey(Buffer.from(prv.slice(0, 64), 'hex'));
    if (!isValidStellarPrivateKey(encodedPrv)) {
        throw new Error('Invalid root private key');
    }
    return stellar.Keypair.fromSecret(encodedPrv);
}
exports.createStellarKeypairFromPrv = createStellarKeypairFromPrv;
/**
 * @deprecated Use isValidStellarPublicKey instead
 *
 * Validates a Stellar public key
 * Stellar public keys are prefixed with 'G'
 * @param pub A Stellar public key to validate
 * @returns Whether the input is a valid Stellar public key
 */
function isValidStellarPub(pub) {
    return stellar.StrKey.isValidEd25519PublicKey(pub);
}
exports.isValidStellarPub = isValidStellarPub;
/**
 * Validates a Stellar public key
 * Stellar public keys are prefixed with 'G'
 * @param pub A Stellar public key to validate
 * @returns Whether the input is a valid Stellar public key
 */
function isValidStellarPublicKey(pub) {
    return stellar.StrKey.isValidEd25519PublicKey(pub);
}
exports.isValidStellarPublicKey = isValidStellarPublicKey;
/**
 * @deprecated Use isValidRootPublicKey instead
 *
 * Validates a ed25519 root public key
 * @param pub A hexadecimal public key to validate
 * @returns Whether the input is a valid public key
 */
function isValidPublicKey(pub) {
    return (0, sdk_core_1.isValidEd25519PublicKey)(pub);
}
exports.isValidPublicKey = isValidPublicKey;
/**
 * Validates a ed25519 root public key
 * @param pub A hexadecimal public key to validate
 * @returns Whether the input is a valid public key
 */
function isValidRootPublicKey(pub) {
    return (0, sdk_core_1.isValidEd25519PublicKey)(pub);
}
exports.isValidRootPublicKey = isValidRootPublicKey;
/**
 * @deprecated Use isValidStellarPrivateKey instead
 *
 * Validates a Stellar private key
 * Stellar private keys are prefixed with 'S'
 * @param seed A Stellar private key to validate
 * @returns Whether the input is a valid Stellar private key
 */
function isValidStellarPrv(seed) {
    return stellar.StrKey.isValidEd25519SecretSeed(seed);
}
exports.isValidStellarPrv = isValidStellarPrv;
/**
 * Validates a Stellar private key
 * Stellar private keys are prefixed with 'S'
 * @param seed A Stellar private key to validate
 * @returns Whether the input is a valid Stellar private key
 */
function isValidStellarPrivateKey(seed) {
    return stellar.StrKey.isValidEd25519SecretSeed(seed);
}
exports.isValidStellarPrivateKey = isValidStellarPrivateKey;
/**
 * @deprecated Use isValidRootPrivateKey instead
 *
 * Validates a ed25519 root private key
 * @param prv A hexadecimal private key to validate
 * @returns Whether the input is a valid private key
 */
function isValidPrivateKey(prv) {
    return (0, sdk_core_1.isValidEd25519SecretKey)(prv);
}
exports.isValidPrivateKey = isValidPrivateKey;
/**
 * Validates a ed25519 root private key
 * @param prv A hexadecimal private key to validate
 * @returns Whether the input is a valid private key
 */
function isValidRootPrivateKey(prv) {
    return (0, sdk_core_1.isValidEd25519SecretKey)(prv);
}
exports.isValidRootPrivateKey = isValidRootPrivateKey;
/**
 * Encodes a raw public key to a G-prefixed Stellar public key
 * @param pub Raw public key
 * @returns Encoded Stellar public key
 */
function encodePublicKey(pub) {
    return stellar.StrKey.encodeEd25519PublicKey(pub);
}
exports.encodePublicKey = encodePublicKey;
/**
 * Encodes a raw private key to a S-prefixed Stellar private key
 * @param prv Raw private key
 * @returns Encoded Stellar private key
 */
function encodePrivateKey(prv) {
    return stellar.StrKey.encodeEd25519SecretSeed(prv);
}
exports.encodePrivateKey = encodePrivateKey;
/**
 * Decodes a Stellar public key to a raw public key
 * @param pub Encoded Stellar G-prefixed public key
 * @returns Raw hexadecimal public key
 */
function decodePublicKey(pub) {
    return stellar.StrKey.decodeEd25519PublicKey(pub);
}
exports.decodePublicKey = decodePublicKey;
/**
 * Decodes a Stellar private key to a raw private key
 * @param prv Encoded Stellar S-prefixed private key
 * @returns Raw hexadecimal private key
 */
function decodePrivateKey(prv) {
    return stellar.StrKey.decodeEd25519SecretSeed(prv);
}
exports.decodePrivateKey = decodePrivateKey;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbGliL3V0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsOENBQW1GO0FBQ25GLHFEQUF1QztBQUV2Qzs7Ozs7R0FLRztBQUNILFNBQWdCLDJCQUEyQixDQUFDLEdBQVc7SUFDckQsSUFBSSxHQUFHLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ3ZCLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUNqQyxNQUFNLElBQUksS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUM7U0FDL0M7UUFDRCxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQzNDO0lBRUQsTUFBTSxVQUFVLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDNUQsSUFBSSxDQUFDLHVCQUF1QixDQUFDLFVBQVUsQ0FBQyxFQUFFO1FBQ3hDLE1BQU0sSUFBSSxLQUFLLENBQUMseUJBQXlCLENBQUMsQ0FBQztLQUM1QztJQUNELE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDbkQsQ0FBQztBQWJELGtFQWFDO0FBRUQ7Ozs7O0dBS0c7QUFDSCxTQUFnQiwyQkFBMkIsQ0FBQyxHQUFXO0lBQ3JELElBQUksR0FBRyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRTtRQUN2QixJQUFJLENBQUMsd0JBQXdCLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDbEMsTUFBTSxJQUFJLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1NBQ2hEO1FBQ0QsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQztLQUN4QztJQUVELE1BQU0sVUFBVSxHQUFHLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUMxRSxJQUFJLENBQUMsd0JBQXdCLENBQUMsVUFBVSxDQUFDLEVBQUU7UUFDekMsTUFBTSxJQUFJLEtBQUssQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0tBQzdDO0lBQ0QsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNoRCxDQUFDO0FBYkQsa0VBYUM7QUFFRDs7Ozs7OztHQU9HO0FBQ0gsU0FBZ0IsaUJBQWlCLENBQUMsR0FBVztJQUMzQyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsdUJBQXVCLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDckQsQ0FBQztBQUZELDhDQUVDO0FBRUQ7Ozs7O0dBS0c7QUFDSCxTQUFnQix1QkFBdUIsQ0FBQyxHQUFXO0lBQ2pELE9BQU8sT0FBTyxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNyRCxDQUFDO0FBRkQsMERBRUM7QUFFRDs7Ozs7O0dBTUc7QUFDSCxTQUFnQixnQkFBZ0IsQ0FBQyxHQUFXO0lBQzFDLE9BQU8sSUFBQSxrQ0FBdUIsRUFBQyxHQUFHLENBQUMsQ0FBQztBQUN0QyxDQUFDO0FBRkQsNENBRUM7QUFFRDs7OztHQUlHO0FBQ0gsU0FBZ0Isb0JBQW9CLENBQUMsR0FBVztJQUM5QyxPQUFPLElBQUEsa0NBQXVCLEVBQUMsR0FBRyxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUZELG9EQUVDO0FBRUQ7Ozs7Ozs7R0FPRztBQUNILFNBQWdCLGlCQUFpQixDQUFDLElBQVk7SUFDNUMsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLHdCQUF3QixDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3ZELENBQUM7QUFGRCw4Q0FFQztBQUVEOzs7OztHQUtHO0FBQ0gsU0FBZ0Isd0JBQXdCLENBQUMsSUFBWTtJQUNuRCxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsd0JBQXdCLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDdkQsQ0FBQztBQUZELDREQUVDO0FBRUQ7Ozs7OztHQU1HO0FBQ0gsU0FBZ0IsaUJBQWlCLENBQUMsR0FBVztJQUMzQyxPQUFPLElBQUEsa0NBQXVCLEVBQUMsR0FBRyxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUZELDhDQUVDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQWdCLHFCQUFxQixDQUFDLEdBQVc7SUFDL0MsT0FBTyxJQUFBLGtDQUF1QixFQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3RDLENBQUM7QUFGRCxzREFFQztBQUVEOzs7O0dBSUc7QUFDSCxTQUFnQixlQUFlLENBQUMsR0FBVztJQUN6QyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsc0JBQXNCLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDcEQsQ0FBQztBQUZELDBDQUVDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQWdCLGdCQUFnQixDQUFDLEdBQVc7SUFDMUMsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLHVCQUF1QixDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3JELENBQUM7QUFGRCw0Q0FFQztBQUVEOzs7O0dBSUc7QUFDSCxTQUFnQixlQUFlLENBQUMsR0FBVztJQUN6QyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsc0JBQXNCLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDcEQsQ0FBQztBQUZELDBDQUVDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQWdCLGdCQUFnQixDQUFDLEdBQVc7SUFDMUMsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLHVCQUF1QixDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3JELENBQUM7QUFGRCw0Q0FFQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzVmFsaWRFZDI1NTE5UHVibGljS2V5LCBpc1ZhbGlkRWQyNTUxOVNlY3JldEtleSB9IGZyb20gJ0BiaXRnby9zZGstY29yZSc7XG5pbXBvcnQgKiBhcyBzdGVsbGFyIGZyb20gJ3N0ZWxsYXItc2RrJztcblxuLyoqXG4gKiBDcmVhdGVzIGEgU3RlbGxhciBrZXlwYWlyIGZyb20gYSBwdWJsaWMga2V5LlxuICogUHVibGljIGtleSBjYW4gYmUgZWl0aGVyIGEgcmF3IHJvb3QgcHVibGljIGtleSAoaGV4IHN0cmluZykgb3IgYSBTdGVsbGFyIHB1YmxpYyBrZXkgKHByZWZpeGVkIHdpdGggJ0cnKVxuICogQHBhcmFtIHB1YiBFaXRoZXIgaGV4IHJvb3QgcHVibGljIGtleSBvciBTdGVsbGFyIHB1YmxpYyBrZXlcbiAqIEByZXR1cm5zIFN0ZWxsYXIga2V5cGFpciBmcm9tIHRoZSBwcm92aWRlZCBwdWJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN0ZWxsYXJLZXlwYWlyRnJvbVB1YihwdWI6IHN0cmluZyk6IHN0ZWxsYXIuS2V5cGFpciB7XG4gIGlmIChwdWIuc3RhcnRzV2l0aCgnRycpKSB7XG4gICAgaWYgKCFpc1ZhbGlkU3RlbGxhclB1YmxpY0tleShwdWIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgU3RlbGxhciBwdWJsaWMga2V5Jyk7XG4gICAgfVxuICAgIHJldHVybiBzdGVsbGFyLktleXBhaXIuZnJvbVB1YmxpY0tleShwdWIpO1xuICB9XG5cbiAgY29uc3QgZW5jb2RlZFB1YiA9IGVuY29kZVB1YmxpY0tleShCdWZmZXIuZnJvbShwdWIsICdoZXgnKSk7XG4gIGlmICghaXNWYWxpZFN0ZWxsYXJQdWJsaWNLZXkoZW5jb2RlZFB1YikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcm9vdCBwdWJsaWMga2V5Jyk7XG4gIH1cbiAgcmV0dXJuIHN0ZWxsYXIuS2V5cGFpci5mcm9tUHVibGljS2V5KGVuY29kZWRQdWIpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBTdGVsbGFyIGtleXBhaXIgZnJvbSBhIHByaXZhdGUga2V5LlxuICogUHJpdmF0ZSBrZXkgY2FuIGJlIGVpdGhlciBhIHJhdyByb290IHByaXZhdGUga2V5IChoZXggc3RyaW5nKSBvciBhIFN0ZWxsYXIgcHJpdmF0ZSBrZXkgKHByZWZpeGVkIHdpdGggJ1MnKS5cbiAqIEBwYXJhbSBzZWNyZXQgRWl0aGVyIGhleCByb290IHByaXZhdGUga2V5IG9yIFN0ZWxsYXIgcHJpdmF0ZSBrZXlcbiAqIEByZXR1cm5zIFN0ZWxsYXIga2V5cGFpciBmcm9tIHRoZSBwcm92aWRlZCBwcnZcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN0ZWxsYXJLZXlwYWlyRnJvbVBydihwcnY6IHN0cmluZyk6IHN0ZWxsYXIuS2V5cGFpciB7XG4gIGlmIChwcnYuc3RhcnRzV2l0aCgnUycpKSB7XG4gICAgaWYgKCFpc1ZhbGlkU3RlbGxhclByaXZhdGVLZXkocHJ2KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFN0ZWxsYXIgcHJpdmF0ZSBrZXknKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0ZWxsYXIuS2V5cGFpci5mcm9tU2VjcmV0KHBydik7XG4gIH1cblxuICBjb25zdCBlbmNvZGVkUHJ2ID0gZW5jb2RlUHJpdmF0ZUtleShCdWZmZXIuZnJvbShwcnYuc2xpY2UoMCwgNjQpLCAnaGV4JykpO1xuICBpZiAoIWlzVmFsaWRTdGVsbGFyUHJpdmF0ZUtleShlbmNvZGVkUHJ2KSkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByb290IHByaXZhdGUga2V5Jyk7XG4gIH1cbiAgcmV0dXJuIHN0ZWxsYXIuS2V5cGFpci5mcm9tU2VjcmV0KGVuY29kZWRQcnYpO1xufVxuXG4vKipcbiAqIEBkZXByZWNhdGVkIFVzZSBpc1ZhbGlkU3RlbGxhclB1YmxpY0tleSBpbnN0ZWFkXG4gKlxuICogVmFsaWRhdGVzIGEgU3RlbGxhciBwdWJsaWMga2V5XG4gKiBTdGVsbGFyIHB1YmxpYyBrZXlzIGFyZSBwcmVmaXhlZCB3aXRoICdHJ1xuICogQHBhcmFtIHB1YiBBIFN0ZWxsYXIgcHVibGljIGtleSB0byB2YWxpZGF0ZVxuICogQHJldHVybnMgV2hldGhlciB0aGUgaW5wdXQgaXMgYSB2YWxpZCBTdGVsbGFyIHB1YmxpYyBrZXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRTdGVsbGFyUHViKHB1Yjogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiBzdGVsbGFyLlN0cktleS5pc1ZhbGlkRWQyNTUxOVB1YmxpY0tleShwdWIpO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyBhIFN0ZWxsYXIgcHVibGljIGtleVxuICogU3RlbGxhciBwdWJsaWMga2V5cyBhcmUgcHJlZml4ZWQgd2l0aCAnRydcbiAqIEBwYXJhbSBwdWIgQSBTdGVsbGFyIHB1YmxpYyBrZXkgdG8gdmFsaWRhdGVcbiAqIEByZXR1cm5zIFdoZXRoZXIgdGhlIGlucHV0IGlzIGEgdmFsaWQgU3RlbGxhciBwdWJsaWMga2V5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkU3RlbGxhclB1YmxpY0tleShwdWI6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gc3RlbGxhci5TdHJLZXkuaXNWYWxpZEVkMjU1MTlQdWJsaWNLZXkocHViKTtcbn1cblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2UgaXNWYWxpZFJvb3RQdWJsaWNLZXkgaW5zdGVhZFxuICpcbiAqIFZhbGlkYXRlcyBhIGVkMjU1MTkgcm9vdCBwdWJsaWMga2V5XG4gKiBAcGFyYW0gcHViIEEgaGV4YWRlY2ltYWwgcHVibGljIGtleSB0byB2YWxpZGF0ZVxuICogQHJldHVybnMgV2hldGhlciB0aGUgaW5wdXQgaXMgYSB2YWxpZCBwdWJsaWMga2V5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkUHVibGljS2V5KHB1Yjogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiBpc1ZhbGlkRWQyNTUxOVB1YmxpY0tleShwdWIpO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyBhIGVkMjU1MTkgcm9vdCBwdWJsaWMga2V5XG4gKiBAcGFyYW0gcHViIEEgaGV4YWRlY2ltYWwgcHVibGljIGtleSB0byB2YWxpZGF0ZVxuICogQHJldHVybnMgV2hldGhlciB0aGUgaW5wdXQgaXMgYSB2YWxpZCBwdWJsaWMga2V5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkUm9vdFB1YmxpY0tleShwdWI6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gaXNWYWxpZEVkMjU1MTlQdWJsaWNLZXkocHViKTtcbn1cblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2UgaXNWYWxpZFN0ZWxsYXJQcml2YXRlS2V5IGluc3RlYWRcbiAqXG4gKiBWYWxpZGF0ZXMgYSBTdGVsbGFyIHByaXZhdGUga2V5XG4gKiBTdGVsbGFyIHByaXZhdGUga2V5cyBhcmUgcHJlZml4ZWQgd2l0aCAnUydcbiAqIEBwYXJhbSBzZWVkIEEgU3RlbGxhciBwcml2YXRlIGtleSB0byB2YWxpZGF0ZVxuICogQHJldHVybnMgV2hldGhlciB0aGUgaW5wdXQgaXMgYSB2YWxpZCBTdGVsbGFyIHByaXZhdGUga2V5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkU3RlbGxhclBydihzZWVkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIHN0ZWxsYXIuU3RyS2V5LmlzVmFsaWRFZDI1NTE5U2VjcmV0U2VlZChzZWVkKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgYSBTdGVsbGFyIHByaXZhdGUga2V5XG4gKiBTdGVsbGFyIHByaXZhdGUga2V5cyBhcmUgcHJlZml4ZWQgd2l0aCAnUydcbiAqIEBwYXJhbSBzZWVkIEEgU3RlbGxhciBwcml2YXRlIGtleSB0byB2YWxpZGF0ZVxuICogQHJldHVybnMgV2hldGhlciB0aGUgaW5wdXQgaXMgYSB2YWxpZCBTdGVsbGFyIHByaXZhdGUga2V5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkU3RlbGxhclByaXZhdGVLZXkoc2VlZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiBzdGVsbGFyLlN0cktleS5pc1ZhbGlkRWQyNTUxOVNlY3JldFNlZWQoc2VlZCk7XG59XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgVXNlIGlzVmFsaWRSb290UHJpdmF0ZUtleSBpbnN0ZWFkXG4gKlxuICogVmFsaWRhdGVzIGEgZWQyNTUxOSByb290IHByaXZhdGUga2V5XG4gKiBAcGFyYW0gcHJ2IEEgaGV4YWRlY2ltYWwgcHJpdmF0ZSBrZXkgdG8gdmFsaWRhdGVcbiAqIEByZXR1cm5zIFdoZXRoZXIgdGhlIGlucHV0IGlzIGEgdmFsaWQgcHJpdmF0ZSBrZXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRQcml2YXRlS2V5KHBydjogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiBpc1ZhbGlkRWQyNTUxOVNlY3JldEtleShwcnYpO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyBhIGVkMjU1MTkgcm9vdCBwcml2YXRlIGtleVxuICogQHBhcmFtIHBydiBBIGhleGFkZWNpbWFsIHByaXZhdGUga2V5IHRvIHZhbGlkYXRlXG4gKiBAcmV0dXJucyBXaGV0aGVyIHRoZSBpbnB1dCBpcyBhIHZhbGlkIHByaXZhdGUga2V5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkUm9vdFByaXZhdGVLZXkocHJ2OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIGlzVmFsaWRFZDI1NTE5U2VjcmV0S2V5KHBydik7XG59XG5cbi8qKlxuICogRW5jb2RlcyBhIHJhdyBwdWJsaWMga2V5IHRvIGEgRy1wcmVmaXhlZCBTdGVsbGFyIHB1YmxpYyBrZXlcbiAqIEBwYXJhbSBwdWIgUmF3IHB1YmxpYyBrZXlcbiAqIEByZXR1cm5zIEVuY29kZWQgU3RlbGxhciBwdWJsaWMga2V5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbmNvZGVQdWJsaWNLZXkocHViOiBCdWZmZXIpOiBzdHJpbmcge1xuICByZXR1cm4gc3RlbGxhci5TdHJLZXkuZW5jb2RlRWQyNTUxOVB1YmxpY0tleShwdWIpO1xufVxuXG4vKipcbiAqIEVuY29kZXMgYSByYXcgcHJpdmF0ZSBrZXkgdG8gYSBTLXByZWZpeGVkIFN0ZWxsYXIgcHJpdmF0ZSBrZXlcbiAqIEBwYXJhbSBwcnYgUmF3IHByaXZhdGUga2V5XG4gKiBAcmV0dXJucyBFbmNvZGVkIFN0ZWxsYXIgcHJpdmF0ZSBrZXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZVByaXZhdGVLZXkocHJ2OiBCdWZmZXIpOiBzdHJpbmcge1xuICByZXR1cm4gc3RlbGxhci5TdHJLZXkuZW5jb2RlRWQyNTUxOVNlY3JldFNlZWQocHJ2KTtcbn1cblxuLyoqXG4gKiBEZWNvZGVzIGEgU3RlbGxhciBwdWJsaWMga2V5IHRvIGEgcmF3IHB1YmxpYyBrZXlcbiAqIEBwYXJhbSBwdWIgRW5jb2RlZCBTdGVsbGFyIEctcHJlZml4ZWQgcHVibGljIGtleVxuICogQHJldHVybnMgUmF3IGhleGFkZWNpbWFsIHB1YmxpYyBrZXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZVB1YmxpY0tleShwdWI6IHN0cmluZyk6IEJ1ZmZlciB7XG4gIHJldHVybiBzdGVsbGFyLlN0cktleS5kZWNvZGVFZDI1NTE5UHVibGljS2V5KHB1Yik7XG59XG5cbi8qKlxuICogRGVjb2RlcyBhIFN0ZWxsYXIgcHJpdmF0ZSBrZXkgdG8gYSByYXcgcHJpdmF0ZSBrZXlcbiAqIEBwYXJhbSBwcnYgRW5jb2RlZCBTdGVsbGFyIFMtcHJlZml4ZWQgcHJpdmF0ZSBrZXlcbiAqIEByZXR1cm5zIFJhdyBoZXhhZGVjaW1hbCBwcml2YXRlIGtleVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlUHJpdmF0ZUtleShwcnY6IHN0cmluZyk6IEJ1ZmZlciB7XG4gIHJldHVybiBzdGVsbGFyLlN0cktleS5kZWNvZGVFZDI1NTE5U2VjcmV0U2VlZChwcnYpO1xufVxuIl19