import * as t from "io-ts";
import { NonEmptyString } from "io-ts-types";

import { MPCv2PartyFromStringOrNumber } from "../../common";

const AuthMessage = t.type({
  message: NonEmptyString,
  signature: NonEmptyString,
});

type AuthMessage = t.TypeOf<typeof AuthMessage>;

export const AuthBroadcastMessage = t.intersection([
  t.type({
    payload: AuthMessage,
    from: MPCv2PartyFromStringOrNumber,
  }),
  t.partial({
    signatureR: AuthMessage,
  }),
]);

export type AuthBroadcastMessage = t.TypeOf<typeof AuthBroadcastMessage>;
